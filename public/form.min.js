var allowedFilenames=/^([\w0â€“9._-])+$/,flat=function(e,a){$.each(e,function(e,t){a[t.name]=t.value})},traverse=function(e,a){flat(e.serializeArray(),a),null!=e.children[0]&&$.each(e.children,function(e){traverse(e,a)})},addItem=function(){$('form[class="form-inline addlist"]').submit(function(e){e.preventDefault();var a={};traverse($(e.target),a),$.ajax({type:"POST",url:"/list/add",data:{item:a.item,name:a.name,length:$("#"+a.name+"-elements").children().length}}).fail(function(){alert("There was a problem")}).done(function(e,t,n){200==n.status&&($("input[placeholder='new item']")[0].value="",$("#"+a.name+"-elements").append(e))}).then(function(){changeItem(),dropItem()})})},changeItem=function(){$('form[action="/change"]').submit(function(e){e.preventDefault();var a={};traverse($(e.target),a),$.ajax({type:"POST",url:"/list/change",data:{name:a.name,index:a.index,value:a.value}}).fail(function(){alert("failed to change entry!")})})},dropItem=function(){$("a[class=drop]").click(function(e){e.preventDefault();var a=$(e.currentTarget),t=a.attr("href"),n=t.slice(1,t.length),l=a.attr("list"),i=a.attr("value");console.log(n),console.log(l),console.log(i),$.ajax({type:"POST",url:"/list/drop",data:{item:n,name:l}}).fail(function(){alert("There was a problem")}).done(function(e,a,t){200==t.status&&$("#"+l).html(e)}).then(function(){addItem(),dropItem(),changeItem()})})},main=function(){$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var a=$(e.target).attr("href");$(a).is(":empty")&&$.ajax({type:"GET",url:"/list/"+a.slice(1,a.length)}).fail(function(e){alert("There was a problem")}).done(function(e,t,n){$(a).html(e)}).then(function(){addItem(),dropItem(),changeItem()})})},addList=function(){$('form[action="/add"]').submit(function(e){e.preventDefault();var a={};traverse($(e.target),a),console.log("addList"),console.log(a),allowedFilenames.test(a.name)?$.ajax({type:"POST",url:"/add",data:{name:a.name}}).fail(function(){alert("There was a problem")}).done(function(e,t,n){$("ul[role='tablist']").append('<li><a href="#'+a.name+'" data-toggle="tab" aria-expanded="false">'+a.name+"</a></li>"),$(".tab-content").append('<div id="'+a.name+'" class="tab-pane"></div>')}).then(function(){main()}).then(function(){$("a[href='#"+a.name+"']").trigger("click"),$("input[placeholder='new list']")[0].value=""}):alert("bad filename give!  try again..")})};main(),addList();
